{"version":3,"sources":["Types.ts","Constants.ts","Cards.ts","component/SampleGrid.tsx","component/CardSequence.tsx","Puzzles.ts","component/LevelDescription.tsx","component/TrackProgress.tsx","component/Board.tsx","Game.ts","App.js","reportWebVitals.js","index.js"],"names":["StepState","StepAction","STEP_COUNT","GRID_WIDTH","SECONDS_PER_STEP","ApplyPatternToPart","pattern","part","updatedSteps","steps","entries","stepIndex","stepAction","currentStep","INCREMENT","OFF","ON","ACCENT","DECREMENT","MAX","ZERO","SHIFT_UP","SHIFT_RIGHT","SHIFT_DOWN","SHIFT_LEFT","processStep","CardImpl","flavor","title","description","image","sampleTarget","this","G","playerParts","sample","Cards","makeBed","IGNORE","cleanChest","placeBelongings","cobwebs","dust1","dust2","washBedsheets","dryBedsheets","gatherBedsheets","placeBedsheets","layFlat","fold","putAway","drop","mop","sweep","vacuum","emptyTrash","feast","rearrange","bus","rinse","scour","dry","laundry","floor","dishes","PatternRows","classSequence","chunkedGrid","chunk","map","row","rowId","className","cellClass","colId","Paper","variant","PartGrid","parts","currentlyPlayingStep","tabIndex","setTabIndex","remainingProps","cellClasses","take","step","index","key","Tabs","value","onChange","_","newValue","p","Tab","label","style","minWidth","SampleGrid","ActionCard","cardId","cardIndex","buttonLabel","onClickCard","onClickEnabled","viewCard","isSelected","emphasizeButton","leftOffset","card","maybeClassSequence","Card","onClick","marginLeft","CardContent","CardActions","Button","evt","stopPropagation","disabled","CardInteractionReducer","lastState","action","type","renderedCardCount","newCard","selectedCard","cardCount","newClasses","range","i","computeClass","cardClasses","Error","CardSequence","cards","unremovable","defaultCardClasses","useReducer","length","sequenceState","dispatch","useEffect","TransitionGroup","component","CSSTransition","enter","exit","classNames","timeout","onEnter","onExited","zIndex","LT_PREFIX","process","Puzzles","levelTrack","targetParts","startingHand","startingSchedule","hints","TurnDescription","turn","onDismiss","useState","lastAcknowledgedTurn","setLastAcknowledgedTurn","show","setShow","onClose","puzzle","Modal","open","descriptionLine","TrackProgress","progress","max","LinearProgress","dedent","text","l","m","re_whitespace","exec","undefined","Math","min","replace","RegExp","ContinueButton","enabled","hasClearedLevel","keyMapper","cy","pitch","duration","bd","ch","sd","sampler","Tone","urls","f4","e4","d4","c4","baseUrl","toDestination","SetupTurn","oldG","Array","from","newG","playerHand","playerSchedule","forEach","playCard","CheckLevelComplete","targetPartIndex","targetPart","currentPart","MyGame","moves","ctx","handSlot","INVALID_MOVE","splice","unshift","removeCard","playerScheduleSlot","removedCardId","cleanState","inOrderStack","reverse","console","log","replayedCardIndex","replayedCardId","clearSchedule","commitSchedule","events","endTurn","onBegin","App","Client","game","board","overrideTrackBars","overrideBPM","trackBars","bpm","start","stop","npcDialog","setNpcDialog","selectedPart","setSelectedPart","lastCard","partOfLastCard","findIndex","e","setCurrentlyPlayingStep","lastPlayedStep","setLastPlayedStep","currentTime","setCurrentTime","isPlaying","setIsPlaying","playerActive","setPlayerActive","player","setPlayer","sequence","setSequence","onStep","time","stepId","play","sequencer","loop","autostart","useCallback","triggerAttackRelease","Grid","container","alignItems","justify","item","xs","toFixed","SwitchTransition","children","join","onViewCard","numPlayers","debug","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.8db64367.chunk.js","sourcesContent":["/**\n * This represents the top-level data model of the game.\n * Any concept of global consequence should be declared (but not implemented) here.\n * Because the compiler can traverse the dependency graph just fine, the order of declaration\n * should be for human consumption.\n * Thus, top level concepts are presented first, and their dependencies are declared later.\n */\n\n\n////////////////////////////////\n// Puzzle Configuration\n\nexport interface Puzzle {\n  title: string;\n  description: Array<string>;\n  levelTrack: string;\n  // Override the usually constant length of the track.\n  overrideTrackBars?: number;\n  // Override the usually constant bpm.\n  overrideBPM?: number;\n  // The musical composition the player is aiming to replicate.\n  targetParts: Array<Part>;\n  // The cards you start with in your hand.\n  startingHand: Array<CardId>;\n  // Any initial state that cannot be removed.\n  startingSchedule: Array<CardId>;\n  // Any dialog prior to cards being scheduled.\n  hints?: Array<string>;\n}\n\nexport interface Part {\n  sample: string;\n  steps: StepSequence;\n};\n\nexport type StepSequence = Array<StepState>;\n\nexport enum StepState {\n  OFF = 0,\n  ON = 1,\n  ACCENT = 2,\n};\n\n//////////////////////////////////////////////////////////\n// Gameplay State (i.e. when trying to solve the puzzle)\n\n// Keep this serializable for easy state management.\nexport interface GameState extends Puzzle {\n  // The player's current parts.\n  playerParts: Array<Part>;\n  // The player's current hand.\n  playerHand: Array<CardId>;\n  // The player's current schedule.\n  playerSchedule: Array<CardId>;\n  // Whether the player has unlocked the next level.\n  hasClearedLevel: boolean;\n}\n\n// The card identifier is just a string for now. This keeps things serializable.\nexport type CardId = string;\n\n//////////////////////////////////////////////////////////\n// Card Concepts\n\nexport interface CardFlavor {\n  title: string;\n  description: string;\n  image?: string;\n};\n\nexport interface Card extends CardFlavor {\n  // Pattern cards have special UI considerations.\n  sampleTarget?: string;\n  pattern?: Pattern;\n  playCard: CardAction;\n};\n\nexport type Pattern = Array<StepAction>;\n\nexport enum StepAction {\n  INCREMENT,\n  DECREMENT,\n  ZERO,\n  MAX,\n  SHIFT_UP,\n  SHIFT_RIGHT,\n  SHIFT_DOWN,\n  SHIFT_LEFT,\n  IGNORE,\n};\n\nexport type CardAction = (G: GameState) => void;","export const GRID_WIDTH: number = 4;\nexport const GRID_HEIGHT: number = 4;\nexport const STEP_COUNT: number = GRID_WIDTH * GRID_HEIGHT;\nexport const DEFAULT_BPM: number = 112;\nexport const DEFAULT_TRACK_BARS: number = 4;\nexport const MAX_HAND_SIZE: number = 6;\nexport const SECONDS_PER_STEP: number = 60.0 / (GRID_WIDTH * DEFAULT_BPM);","import { GRID_WIDTH, STEP_COUNT } from \"./Constants\";\nimport { Card, CardFlavor, GameState, Part, Pattern, StepAction, StepState } from \"./Types\";\n\n// Separate from CardImpl, for UI/preview purposes.\nexport const ApplyPatternToPart: (pattern: Pattern, part: Part) => void = (pattern, part) => {\n  const updatedSteps = [...part.steps];\n  for (const [stepIndex, stepAction] of pattern.entries()) {\n    const processStep: () => StepState = () => {\n      const currentStep = part.steps[stepIndex];\n      switch (stepAction) {\n        case StepAction.INCREMENT:\n          if (currentStep === StepState.OFF) {\n            return StepState.ON;\n          } else {\n            return StepState.ACCENT;\n          }\n        case StepAction.DECREMENT:\n          if (currentStep === StepState.ACCENT) {\n            return StepState.ON;\n          } else {\n            return StepState.OFF;\n          }\n        case StepAction.MAX:\n          return StepState.ACCENT;\n        case StepAction.ZERO:\n          return StepState.OFF;\n        case StepAction.SHIFT_UP:\n          if (stepIndex + GRID_WIDTH > STEP_COUNT) {\n            return StepState.OFF\n          }\n          return part.steps[stepIndex + GRID_WIDTH];\n        case StepAction.SHIFT_RIGHT:\n          if ((stepIndex % GRID_WIDTH) === 0) {\n            return StepState.OFF;\n          }\n          return part.steps[stepIndex - 1];\n        case StepAction.SHIFT_DOWN:\n          if (stepIndex - GRID_WIDTH < 0) {\n            return StepState.OFF;\n          }\n          return part.steps[stepIndex - GRID_WIDTH];\n        case StepAction.SHIFT_LEFT:\n          if ((stepIndex % GRID_WIDTH) + 1 === GRID_WIDTH) {\n            return StepState.OFF;\n          }\n          return part.steps[stepIndex + 1];\n        default:\n          return currentStep;\n      }\n    }\n    updatedSteps[stepIndex] = processStep();\n  }\n  part.steps = updatedSteps;\n}\n\nclass CardImpl implements Card {\n  title: string;\n  description: string;\n  image?: string;\n  sampleTarget?: string;\n  pattern?: Pattern;\n\n  constructor(flavor: CardFlavor, pattern?: Pattern, part?: string) {\n    this.title = flavor.title;\n    this.description = flavor.description;\n    this.image = flavor.image;\n    this.pattern = pattern;\n    this.sampleTarget = part;\n  }\n\n  playCard(G: GameState) {\n    for (const part of G.playerParts) {\n      if (part.sample !== this.sampleTarget) {\n        continue;\n      }\n      if (this.pattern) {\n        ApplyPatternToPart(this.pattern, part);\n      }\n    }\n  }\n}\n\nconst Cards : {[key: string]: Card} = {\n  makeBed: new CardImpl(\n    {\n      title: \"Make Bed\",\n      description: `\n        ***You make your bed.***\n\n        Hmm, did you notice that sound?\n\n        Anyway, let's keep working...\n      `\n    },\n    [\n      StepAction.INCREMENT, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.INCREMENT, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n    ],\n    \"bd\"\n  ),\n  cleanChest: new CardImpl(\n    {\n      title: \"Clean Chest\",\n      description: `\n        ***You clean the dusty chest beside your bed.***\n\n        I'm really not imagining this music am I?\n      `\n    },\n    [\n      StepAction.INCREMENT, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.INCREMENT, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n    ],\n    \"bd\"\n  ),\n  placeBelongings: new CardImpl(\n    {\n      title: \"Place Belongings\",\n      description: `\n        ***You put your belongings into the chest.***\n\n        Whoah, that made things louder... That's pretty groovy!\n\n        Let's check back in with ??? to see what to do **NEXT**.\n      `\n    },\n    [\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.MAX, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n    ],\n    \"bd\"\n  ),\n  cobwebs: new CardImpl(\n    {\n      title: \"Cobwebs\",\n      description: `\n        Why don't we start by dusting away all these cobwebs?\n\n        They sure are layered pretty thick in these corners.\n      `\n    },\n    [\n      StepAction.MAX, StepAction.INCREMENT, StepAction.INCREMENT, StepAction.MAX,\n      StepAction.INCREMENT, StepAction.INCREMENT, StepAction.INCREMENT, StepAction.INCREMENT,\n      StepAction.INCREMENT, StepAction.INCREMENT, StepAction.INCREMENT, StepAction.INCREMENT,\n      StepAction.MAX, StepAction.INCREMENT, StepAction.INCREMENT, StepAction.MAX,\n    ],\n    \"ch\"\n  ),\n  dust1: new CardImpl(\n    {\n      title: \"Dust 1\",\n      description: `\n        ***You do a quick sweep of the whole room.***\n\n        That seemed to clear things up a bunch.\n\n        Let's keep at it!\n      `\n    },\n    [\n      StepAction.IGNORE, StepAction.DECREMENT, StepAction.IGNORE, StepAction.DECREMENT,\n      StepAction.IGNORE, StepAction.DECREMENT, StepAction.IGNORE, StepAction.DECREMENT,\n      StepAction.IGNORE, StepAction.DECREMENT, StepAction.IGNORE, StepAction.DECREMENT,\n      StepAction.IGNORE, StepAction.DECREMENT, StepAction.IGNORE, StepAction.DECREMENT,\n    ],\n    \"ch\"\n  ),\n  dust2: new CardImpl(\n    {\n      title: \"Dust 2\",\n      description: `\n        ***You scrub those hard-to-reach corners.***\n\n        Wow! This bunk is really starting to feel like home!\n\n        Too bad dust got on all the bedsheets; let's launder those ***NEXT***!\n      `\n    },\n    [\n      StepAction.DECREMENT, StepAction.IGNORE, StepAction.IGNORE, StepAction.DECREMENT,\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.DECREMENT, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n    ],\n    \"ch\"\n  ),\n  washBedsheets: new CardImpl(\n    {\n      title: \"Wash Bedsheets\",\n      description: `\n        ***You wash the bedsheets.***\n      `\n    },\n    [\n      StepAction.IGNORE, StepAction.INCREMENT, StepAction.IGNORE, StepAction.INCREMENT,\n      StepAction.IGNORE, StepAction.INCREMENT, StepAction.IGNORE, StepAction.INCREMENT,\n      StepAction.IGNORE, StepAction.INCREMENT, StepAction.IGNORE, StepAction.INCREMENT,\n      StepAction.IGNORE, StepAction.INCREMENT, StepAction.INCREMENT, StepAction.INCREMENT,\n    ],\n    \"ch\"\n  ),\n  dryBedsheets: new CardImpl(\n    {\n      title: \"Dry Bedsheets\",\n      description: `\n        ***You hang your bedsheets up to dry.***\n      `\n    },\n    [\n      StepAction.SHIFT_LEFT, StepAction.SHIFT_RIGHT, StepAction.SHIFT_LEFT, StepAction.SHIFT_RIGHT,\n      StepAction.SHIFT_LEFT, StepAction.SHIFT_RIGHT, StepAction.SHIFT_LEFT, StepAction.SHIFT_RIGHT,\n      StepAction.SHIFT_LEFT, StepAction.SHIFT_RIGHT, StepAction.SHIFT_LEFT, StepAction.SHIFT_RIGHT,\n      StepAction.SHIFT_LEFT, StepAction.SHIFT_RIGHT, StepAction.SHIFT_LEFT, StepAction.SHIFT_RIGHT,\n    ],\n    \"ch\"\n  ),\n  gatherBedsheets: new CardImpl(\n    {\n      title: \"Gather Bedsheets\",\n      description: `\n        ***You take down your now dry and fresh bedsheets.***\n\n        Cool! Even moving things around makes music too!\n      `\n    },\n    [\n      StepAction.INCREMENT, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.MAX, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.INCREMENT, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.MAX, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n    ],\n    \"bd\"\n  ),\n  placeBedsheets: new CardImpl(\n    {\n      title: \"Place Bedsheets\",\n      description: `\n        ***You re-make the bed with the fresh bedsheets.***\n\n        I hear a knock on the door. Let's see what's ***NEXT***.\n      `\n    },\n    [\n      StepAction.SHIFT_UP, StepAction.SHIFT_UP, StepAction.SHIFT_UP, StepAction.SHIFT_UP,\n      StepAction.SHIFT_DOWN, StepAction.SHIFT_DOWN, StepAction.SHIFT_DOWN, StepAction.SHIFT_DOWN,\n      StepAction.SHIFT_UP, StepAction.SHIFT_UP, StepAction.SHIFT_UP, StepAction.SHIFT_UP,\n      StepAction.SHIFT_DOWN, StepAction.SHIFT_DOWN, StepAction.SHIFT_DOWN, StepAction.SHIFT_DOWN,\n    ],\n    \"bd\"\n  ),\n\n\n\n\n  layFlat: new CardImpl(\n    {\n      title: \"Lay Flat\",\n      description: \"Lay your shirt flat on your bed. The foundation of any laundry folding routine.\"\n    },\n    [\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.INCREMENT, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n    ],\n    \"sd\"\n  ),\n  fold: new CardImpl(\n    {\n      title: \"Fold\",\n      description: \"Fold your shirt. Add some complexity! (Assuming you have something to start with...)\"\n    },\n    [\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.INCREMENT, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n    ],\n    \"sd\"\n  ),\n  putAway: new CardImpl(\n    {\n      title: \"Put Away\",\n      description: \"Put away your freshly folded clothes.\"\n    },\n    [\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.MAX, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n    ],\n    \"sd\"\n  ),\n  drop: new CardImpl(\n    {\n      title: \"The Mess\",\n      description: \"Oops! You dropped your [?] all over the floor. What a mess...\"\n    },\n    [\n      StepAction.MAX, StepAction.MAX, StepAction.MAX, StepAction.MAX,\n      StepAction.MAX, StepAction.MAX, StepAction.MAX, StepAction.MAX,\n      StepAction.MAX, StepAction.MAX, StepAction.MAX, StepAction.MAX,\n      StepAction.MAX, StepAction.MAX, StepAction.MAX, StepAction.MAX,\n    ],\n    \"bd\"\n  ),\n  mop: new CardImpl(\n    {\n      title: \"Mop\",\n      description: \"Mop the floor. This mess might be a bit too much to soak up though.\"\n    },\n    [\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.DECREMENT, StepAction.DECREMENT,\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.DECREMENT, StepAction.DECREMENT,\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.DECREMENT, StepAction.DECREMENT,\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.DECREMENT, StepAction.DECREMENT,\n    ],\n    \"bd\"\n  ),\n  sweep: new CardImpl(\n    {\n      title: \"Sweep\",\n      description: \"Sweep the floor. It's a bit hard to get the corners though..\"\n    },\n    [\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.DECREMENT, StepAction.IGNORE,\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.DECREMENT, StepAction.DECREMENT,\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.DECREMENT, StepAction.DECREMENT,\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.DECREMENT, StepAction.IGNORE,\n    ],\n    \"bd\"\n  ),\n  vacuum: new CardImpl(\n    {\n      title: \"Vacuum\",\n      description: \"Suck up whatever is left.\"\n    },\n    [\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE, StepAction.DECREMENT,\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE, StepAction.DECREMENT,\n    ],\n    \"bd\"\n  ),\n  emptyTrash: new CardImpl(\n    {\n      title: \"Empty Trash\",\n      description: \"Those bins were chalk full of [???]! Much better now...\"\n    },\n    [\n      StepAction.IGNORE, StepAction.ZERO, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.IGNORE, StepAction.ZERO, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.IGNORE, StepAction.ZERO, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.IGNORE, StepAction.ZERO, StepAction.IGNORE, StepAction.IGNORE,\n    ],\n    \"bd\"\n  ),\n  feast: new CardImpl(\n    {\n      title: \"Feast\",\n      description: \"What a delicious meal! What are we going to do about all the dishes?\"\n    },\n    [\n      StepAction.INCREMENT, StepAction.INCREMENT, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.INCREMENT, StepAction.INCREMENT, StepAction.IGNORE, StepAction.MAX,\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.MAX, StepAction.IGNORE, StepAction.MAX, StepAction.MAX,\n    ],\n    \"ch\"\n  ),\n  rearrange: new CardImpl(\n    {\n      title: \"Rearrange\",\n      description: \"All the chairs and tables have been moved away from their original places!\"\n    },\n    [\n      StepAction.SHIFT_LEFT, StepAction.SHIFT_UP, StepAction.SHIFT_LEFT, StepAction.SHIFT_UP,\n      StepAction.SHIFT_DOWN, StepAction.SHIFT_UP, StepAction.SHIFT_DOWN, StepAction.SHIFT_UP,\n      StepAction.SHIFT_DOWN, StepAction.SHIFT_UP, StepAction.SHIFT_DOWN, StepAction.SHIFT_UP,\n      StepAction.SHIFT_DOWN, StepAction.SHIFT_RIGHT, StepAction.SHIFT_DOWN, StepAction.SHIFT_RIGHT,\n    ],\n    \"ch\"\n\n  ),\n  bus: new CardImpl(\n    {\n      title: \"Bus\",\n      description: \"What a delicious meal! What are we going to do about all the dishes?\"\n    },\n    [\n      StepAction.SHIFT_LEFT, StepAction.SHIFT_LEFT, StepAction.SHIFT_LEFT, StepAction.SHIFT_UP,\n      StepAction.SHIFT_DOWN, StepAction.IGNORE, StepAction.IGNORE, StepAction.SHIFT_UP,\n      StepAction.SHIFT_DOWN, StepAction.IGNORE, StepAction.IGNORE, StepAction.SHIFT_UP,\n      StepAction.SHIFT_DOWN, StepAction.SHIFT_RIGHT, StepAction.SHIFT_RIGHT, StepAction.SHIFT_RIGHT,\n    ],\n    \"ch\"\n  ),\n  rinse: new CardImpl(\n    {\n      title: \"Rinse\",\n      description: \"Rinse the dishes. This will make them easier to clean.\"\n    },\n    [\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.SHIFT_LEFT, StepAction.SHIFT_UP, StepAction.SHIFT_LEFT, StepAction.SHIFT_UP,\n      StepAction.SHIFT_DOWN, StepAction.SHIFT_RIGHT, StepAction.SHIFT_DOWN, StepAction.SHIFT_RIGHT,\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n    ],\n    \"ch\"\n  ),\n  scour: new CardImpl(\n    {\n      title: \"Scour\",\n      description: \"Scour the dishes. Really put your back into it.\"\n    },\n    [\n      StepAction.SHIFT_LEFT, StepAction.SHIFT_RIGHT, StepAction.SHIFT_LEFT, StepAction.SHIFT_RIGHT,\n      StepAction.SHIFT_LEFT, StepAction.SHIFT_UP, StepAction.SHIFT_UP, StepAction.SHIFT_RIGHT,\n      StepAction.SHIFT_DOWN, StepAction.SHIFT_RIGHT, StepAction.SHIFT_LEFT, StepAction.SHIFT_DOWN,\n      StepAction.SHIFT_LEFT, StepAction.SHIFT_RIGHT, StepAction.SHIFT_LEFT, StepAction.SHIFT_RIGHT,\n    ],\n    \"ch\"\n  ),\n  dry: new CardImpl(\n    {\n      title: \"Dry\",\n      description: \"Let the dishes dry. What a lovely sight!\"\n    },\n    [\n      StepAction.SHIFT_LEFT, StepAction.SHIFT_RIGHT, StepAction.SHIFT_LEFT, StepAction.SHIFT_RIGHT,\n      StepAction.SHIFT_LEFT, StepAction.SHIFT_RIGHT, StepAction.SHIFT_LEFT, StepAction.SHIFT_RIGHT,\n      StepAction.SHIFT_LEFT, StepAction.SHIFT_RIGHT, StepAction.SHIFT_LEFT, StepAction.SHIFT_RIGHT,\n      StepAction.SHIFT_LEFT, StepAction.SHIFT_RIGHT, StepAction.SHIFT_LEFT, StepAction.SHIFT_RIGHT,\n\n    ],\n    \"ch\"\n  ),\n  laundry: new CardImpl(\n    {\n      title: \"Laundry\",\n      description: \"Do the laundry. You know how!\"\n    },\n    [\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.MAX, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.MAX, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n    ],\n    \"sd\"\n  ),\n  floor: new CardImpl(\n    {\n      title: \"Floor\",\n      description: \"Clean the floor. You know how!\"\n    },\n    [\n      StepAction.INCREMENT, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.INCREMENT, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.INCREMENT, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n      StepAction.INCREMENT, StepAction.IGNORE, StepAction.IGNORE, StepAction.IGNORE,\n    ],\n    \"bd\"\n  ),\n  dishes: new CardImpl(\n    {\n      title: \"Dishes\",\n      description: \"Do the dishes. You know how!\"\n    },\n    [\n      StepAction.INCREMENT, StepAction.IGNORE, StepAction.MAX, StepAction.IGNORE,\n      StepAction.INCREMENT, StepAction.IGNORE, StepAction.MAX, StepAction.IGNORE,\n      StepAction.INCREMENT, StepAction.IGNORE, StepAction.MAX, StepAction.IGNORE,\n      StepAction.INCREMENT, StepAction.IGNORE, StepAction.MAX, StepAction.IGNORE,\n    ],\n    \"ch\"\n  )\n};\n\nexport default Cards;","import React from 'react';\n\nimport {\n  Paper,\n  Tab,\n  Tabs,\n} from '@material-ui/core';\n\nimport {\n  chunk,\n  take,\n} from 'lodash';\n\nimport {\n  GRID_WIDTH,\n  STEP_COUNT,\n} from '../Constants';\nimport { Part, StepSequence, StepState } from '../Types';\n\nexport function PatternRows(\n  { classSequence, ...remainingProps } : React.HTMLAttributes<HTMLElement> & {\n    classSequence: Array<string>,\n  }\n) {\n  const chunkedGrid: Array<Array<string>> = chunk(classSequence, GRID_WIDTH);\n  return <>\n    {\n    chunkedGrid.map((row: Array<string>, rowId: number) => (\n      <tr key={\"row \" + rowId} className=\"row\">\n      {\n        row.map((cellClass: string, colId: number) => {\n          return (\n            <td key={\"col \" + colId} className={cellClass}>\n              <Paper className=\"step\" variant=\"outlined\"/>\n            </td>\n          );\n        })\n      }\n      </tr>\n    ))\n    }\n  </>;\n};\n\nfunction PartGrid(\n  { parts, currentlyPlayingStep, tabIndex, setTabIndex, ...remainingProps }: React.HTMLAttributes<HTMLElement> & {\n    parts: Array<Part>, currentlyPlayingStep: number | null, tabIndex: number, setTabIndex: any\n  }\n)\n{\n  const {\n    steps,\n    sample,\n  } = parts[tabIndex];\n  const truncatedSteps: StepSequence = take(steps, STEP_COUNT);\n  const cellClasses: Array<string> = truncatedSteps.map((step: StepState, index: number) => {\n    let cellClass = \"cell \";\n    cellClass += StepState[step] as string + \" \";\n    if (currentlyPlayingStep !== null && index === currentlyPlayingStep % STEP_COUNT) {\n      cellClass += \"playing\";\n    }\n    return cellClass;\n  });\n\n  return (\n    <table {...remainingProps} key={tabIndex}>\n      <caption>\n        <Tabs\n          variant=\"fullWidth\"\n          value={tabIndex}\n          onChange={(_, newValue: number) => setTabIndex(newValue)}\n          className=\"part-selector\"\n        >\n          {\n            parts.map((p: Part, index: number) =>\n              <Tab\n                key={\"tab \" + index}\n                label={p.sample}\n                style={{ minWidth: 48 }}\n              />\n            )\n          }\n        </Tabs>\n      </caption>\n      <tbody className={sample}>\n        <PatternRows\n          classSequence={cellClasses}\n        />\n      </tbody>\n    </table>\n  );\n}\n\nexport default function SampleGrid(\n  { parts, currentlyPlayingStep, tabIndex, setTabIndex, ...remainingProps }: React.HTMLAttributes<HTMLElement> & {\n    parts: Array<Part>, currentlyPlayingStep: number | null, tabIndex: number, setTabIndex: any\n  }\n) {\n  return <>\n    <PartGrid\n      parts={parts}\n      tabIndex={tabIndex}\n      setTabIndex={setTabIndex}\n      currentlyPlayingStep={currentlyPlayingStep}\n      {...remainingProps}\n    />\n  </>\n};","import { Button, Card, CardActions, CardContent } from \"@material-ui/core\";\nimport { range } from \"lodash\";\nimport { ReactElement, useEffect, useReducer } from \"react\";\nimport { TransitionGroup, CSSTransition } from \"react-transition-group\";\n\nimport Cards from '../Cards';\nimport { MAX_HAND_SIZE } from \"../Constants\";\nimport { CardId, StepAction } from \"../Types\";\nimport { PatternRows } from \"./SampleGrid\";\n\nexport function ActionCard({\n  cardId, cardIndex, buttonLabel, onClickCard, onClickEnabled, viewCard, isSelected, emphasizeButton,\n  leftOffset\n}: {\n  cardId: CardId, cardIndex: number, buttonLabel: string, onClickCard: any,\n  onClickEnabled: boolean, viewCard: any, isSelected: boolean, emphasizeButton: boolean,\n  leftOffset: number\n} & React.HTMLAttributes<HTMLDivElement>) : ReactElement\n{\n  const card = Cards[cardId];\n  const maybeClassSequence = card.pattern?.map(\n    (stepAction: StepAction) => \"cell \" + StepAction[stepAction] as string\n  );\n  return <Card\n    variant=\"outlined\"\n    className={\"card \" + card.sampleTarget + (isSelected ? \" selected\" : \"\")}\n    onClick={viewCard}\n    style={{\n      marginLeft: leftOffset + \"px\"\n    }}\n  >\n    <CardContent>\n      {maybeClassSequence && \n        <table className=\"pattern\">\n          <tbody>\n            <PatternRows\n              classSequence={maybeClassSequence}\n            />\n          </tbody>\n        </table>\n      }\n    </CardContent> \n    <CardActions>\n      {onClickEnabled ? \n        <Button\n          variant=\"contained\"\n          onClick={(evt) => {\n            onClickCard(cardIndex);\n            evt.stopPropagation();\n          }}\n          disabled={!isSelected}\n          className={emphasizeButton ? \"emphasis\" : \"\"}\n        >\n          {buttonLabel}\n        </Button>         \n        :\n        <div className=\"card-fixed\">\n          FIXED\n        </div>\n      }\n    </CardActions>\n  </Card>;\n};\n\nexport function EmptyCardSlot(): ReactElement {\n  return <Card variant=\"outlined\" className=\"card empty\">\n    <CardContent>\n      &nbsp;\n    </CardContent> \n  </Card>\n}\n\ninterface CardInteraction {\n  type: string;\n  value?: any;\n};\n\ninterface SequenceState {\n  selectedCard: number;\n  cardClasses: Array<any>;\n  cardCount: number;\n  renderedCardCount: number; \n};\n\nconst CardInteractionReducer: (lastState: SequenceState, action: CardInteraction) => SequenceState =\n  (lastState: SequenceState, action: CardInteraction) => {\n    switch (action.type) {\n      // These two transitions are purely for tracking transient animation states.\n      case 'enter':\n        return {\n          ...lastState,\n          renderedCardCount: lastState.renderedCardCount + 1,\n        };\n      case 'exited':\n        return {\n          ...lastState,\n          renderedCardCount: lastState.renderedCardCount - 1,\n        };\n      // This is the race-safe implementation for how to handle card selections.\n      case 'select-card': {\n        const newCard = action.value !== lastState.selectedCard ? action.value : (\n          action.value < lastState.cardCount - 1 ? \n            action.value + 1 : 0 \n        );\n        const computeClass: (i: number) => string = (i) => {\n          if (i < newCard) {\n            return \"displace\";\n          } else {\n            return \"show\";\n          }\n        };\n        const newClasses = range(MAX_HAND_SIZE).map((i) => \"card-\" + computeClass(i));\n        return {\n          ...lastState,\n          cardClasses: newClasses,\n          selectedCard: newCard,\n        }\n      }\n      case 'reset': {\n        return {\n          ...action.value,\n          // Preserve the rendered card count?\n          renderedCardCount: lastState.renderedCardCount\n        };\n      }\n      default:\n        throw new Error(\"Unrecognized action.\");\n    }\n};\n\nexport default function CardSequence({\n  cards, buttonLabel, onClickCard, unremovable, className, emphasizeButton, ...remainingProps\n}: {\n  cards: Array<CardId>, buttonLabel: string, onClickCard: any, unremovable: number, emphasizeButton: boolean\n} & React.HTMLAttributes<HTMLDivElement>) {\n  const defaultCardClasses = range(MAX_HAND_SIZE).map(() => 'card-show');\n  const [sequenceState, dispatch] = useReducer(CardInteractionReducer, {\n    cardCount: cards.length,\n    selectedCard: 0,\n    cardClasses: defaultCardClasses,\n    renderedCardCount: cards.length,\n  });\n  // Sometimes we have an inbound update to cards that we need to reconcile with our controlled\n  // sequence state... Just reset.\n  useEffect(() => {\n    if (cards.length !== sequenceState.cardCount) {\n      dispatch({\n        type: \"reset\",\n        value: {\n          cardCount: cards.length,\n          selectedCard: 0,\n          cardClasses: defaultCardClasses,\n        }\n      })\n    }\n  }, [cards.length, defaultCardClasses, sequenceState.cardCount])\n  return <div className={\"sequence \" + className}>\n    <TransitionGroup component={null}>\n    {\n    cards.map((cardId: CardId, index: number) => \n      <CSSTransition\n        key={cardId}\n        enter={true}\n        exit={true}\n        classNames=\"card\"\n        timeout={200}\n        onEnter={() => dispatch({type: 'enter', value: cards.length})}\n        onExited={() => dispatch({type: 'exited', value: cards.length})}\n      >\n        <div\n          className={\"card-slot \" + sequenceState.cardClasses[index]}\n          style={{\n            zIndex: MAX_HAND_SIZE - index,\n          }}\n        >\n          <ActionCard\n            cardId={cardId}\n            cardIndex={index}\n            buttonLabel={buttonLabel}\n            onClickCard={() => onClickCard(index)}\n            onClickEnabled={cards.length - index > unremovable}\n            viewCard={() => {\n              dispatch({\n                type: \"select-card\",\n                value: index,\n              });\n            }}\n            isSelected={index === sequenceState.selectedCard}\n            emphasizeButton={emphasizeButton}\n            leftOffset={18 * (MAX_HAND_SIZE - sequenceState.renderedCardCount - 1)}\n          />\n          { cards.length - index > unremovable &&\n            <div className=\"card-order\" onClick={() => dispatch({type: \"select-card\", value: index,})}>\n              {cards.length - index - unremovable}\n            </div> \n          }\n        </div>\n      </CSSTransition>\n    )\n    }\n    </TransitionGroup>\n  </div>;\n};","import { Puzzle, StepState } from \"./Types\";\n\nconst LT_PREFIX = process.env.PUBLIC_URL + \"/samples/levels/\";\nconst Puzzles: Array<Puzzle> = [\n  { \n    title: \"The Bunk: Part I\",\n    description: [\n      \"Welcome Neon!\",\n      \"I'm [???], and I'm supposed to show you to your bunk.\",\n      \"Your training starts tomorrow, so why don't you get settled first?\"\n    ],\n    levelTrack: `${LT_PREFIX}unmixed_0_1_112_bpm.ogg`,\n    targetParts: [\n      {\n        sample: \"bd\",\n        steps: [\n          StepState.ACCENT, StepState.OFF, StepState.OFF, StepState.OFF,\n          StepState.ON, StepState.OFF, StepState.OFF, StepState.OFF,\n          StepState.ACCENT, StepState.OFF, StepState.OFF, StepState.OFF,\n          StepState.ON, StepState.OFF, StepState.OFF, StepState.OFF,\n        ]\n      }\n    ],\n    startingHand: [\n      \"makeBed\",\n      \"cleanChest\",\n      \"placeBelongings\",\n    ],\n    startingSchedule: [],\n    hints: [\n      \"**PLACE** items from your **To-Do** list on your **Schedule** and get to work!\",\n      \"Keep an eye on what happens when you add a task to your schedule!\"\n    ],\n  },\n  {\n    title: \"The Bunk: Part II\",\n    description: [\n      \"Hmmm... I can't seem to find ??? anywhere.\",\n      \"Might as well keep cleaning.\",\n      \"Let's make this bunk sparkle!\"\n    ],\n    levelTrack: `${LT_PREFIX}unmixed_0_1_112_bpm.ogg`,\n    targetParts: [\n      {\n        sample: \"ch\",\n        steps: [\n          StepState.ON, StepState.OFF, StepState.ON, StepState.OFF,\n          StepState.ON, StepState.OFF, StepState.ON, StepState.OFF,\n          StepState.ON, StepState.OFF, StepState.ON, StepState.OFF,\n          StepState.ON, StepState.OFF, StepState.ON, StepState.ON,\n        ]\n      }\n    ],\n    startingHand: [\n      \"dust1\",\n      \"dust2\",\n    ],\n    startingSchedule: [\n      \"cobwebs\",\n    ],\n    hints: [\n      \"Why don't we start by dusting away all these cobwebs?\",\n      \"They sure are layered pretty thick in these corners.\"\n    ]\n  },\n  {\n    title: \"The Bunk: Part III\",\n    description: [\n      \"??? is still nowhere to be found.\",\n      \"Might as well clean those bedsheets then.\",\n    ],\n    levelTrack: `${LT_PREFIX}unmixed_0_1_112_bpm.ogg`,\n    targetParts: [\n      {\n        sample: \"ch\",\n        steps: [\n          StepState.ON, StepState.OFF, StepState.ON, StepState.OFF,\n          StepState.ON, StepState.OFF, StepState.ON, StepState.OFF,\n          StepState.ON, StepState.OFF, StepState.ON, StepState.OFF,\n          StepState.ON, StepState.OFF, StepState.ON, StepState.ON,\n        ]\n      },\n      {\n        sample: \"bd\",\n        steps: [\n          StepState.ACCENT, StepState.OFF, StepState.OFF, StepState.OFF,\n          StepState.ON, StepState.OFF, StepState.OFF, StepState.OFF,\n          StepState.ACCENT, StepState.OFF, StepState.OFF, StepState.OFF,\n          StepState.ON, StepState.OFF, StepState.OFF, StepState.OFF,\n        ]\n      }\n\n    ],\n    startingHand: [\n      \"washBedsheets\",\n      \"dryBedsheets\",\n      \"gatherBedsheets\",\n      \"placeBedsheets\",\n    ],\n    startingSchedule: [\n    ],\n    hints: [\n      \"Is the music guiding me somehow?\",\n    ]\n  },\n \n \n \n  // 0\n  /*\n  {\n    title: \"The Dojo\",\n    description: [\n      \"Hello, Neon...\",\n      \"We have been eagerly awaiting your arrival at the <???> Dojo.\",\n      \"I am <???>, and I have been tasked with guiding you to your living quarters.\",\n      \"Your training shall begin shortly, but why don't you first get settled in?\"\n    ],\n    levelTrack: `${LT_PREFIX}unmixed_1_1_88_bpm.ogg`,\n    targetParts: [\n      {\n        sample: \"ch\",\n        steps: [\n          StepState.ON, StepState.OFF, StepState.OFF, StepState.OFF,\n          StepState.OFF, StepState.OFF, StepState.OFF, StepState.OFF,\n          StepState.ACCENT, StepState.OFF, StepState.OFF, StepState.OFF,\n          StepState.OFF, StepState.OFF, StepState.OFF, StepState.OFF,\n        ]\n      }\n    ],\n    startingHand: [\n      \"makeBed\",\n      \"cleanChest\",\n    ],\n    startingSchedule: [],\n  },\n  */\n  /*\n  {\n    title: \"The Laundry\",\n    description: [\n      \"Hey Neon, are you settled in yet?\",\n      \"I'm [???] and I'm a specialist in [???].\",\n      \"Your training starts today.\"\n    ],\n    levelTrack: `${LT_PREFIX}unmixed_1_1_88_bpm.ogg`,\n    targetParts: [\n      {\n        sample: \"sd\",\n        steps: [\n          StepState.OFF, StepState.OFF, StepState.OFF, StepState.OFF,\n          StepState.ACCENT, StepState.OFF, StepState.OFF, StepState.OFF,\n          StepState.OFF, StepState.OFF, StepState.OFF, StepState.OFF,\n          StepState.ACCENT, StepState.OFF, StepState.OFF, StepState.OFF,\n        ],\n      },\n    ],\n    startingHand: [\n      \"layFlat\",\n      \"fold\",\n      \"putAway\"\n    ],\n    startingSchedule: [],\n    hints: [\n      \"Why don't we get started by doing the laundry?\",\n      \"**PLACE** items from your **To-Do** list on your **Schedule** and get to work!\",\n    ],\n  },\n  // 1\n  {\n    title: \"The Floor\",\n    description: [\n      \"Nice work on that laundry!\",\n      \"Let me introduce you to [???].\",\n      \"We're only just getting started...\",\n    ],\n    levelTrack: `${LT_PREFIX}unmixed_1_2_88_bpm.ogg`,\n    targetParts: [\n      {\n        sample: \"bd\",\n        steps: [\n          StepState.ACCENT, StepState.OFF, StepState.OFF, StepState.OFF,\n          StepState.ACCENT, StepState.OFF, StepState.OFF, StepState.OFF,\n          StepState.ACCENT, StepState.OFF, StepState.OFF, StepState.OFF,\n          StepState.ACCENT, StepState.OFF, StepState.OFF, StepState.OFF,\n        ],\n      },\n    ],\n    startingHand:  [\n      \"mop\",\n      \"sweep\",\n      \"vacuum\",\n      \"emptyTrash\",\n    ],\n    startingSchedule: [\n      \"drop\",\n    ],\n    hints: [\n      \"That's a big mess to tidy up!\",\n      \"Just like with music, sometimes what's missing is heard loudest.\"\n    ],\n  },\n  // 2\n  {\n    title: \"After Dinner\",\n    description: [\n      \"Everything's right back in its place.\",\n      \"You can head to the mess hall now.\",\n      \"[???] will serve you your dinner.\"\n    ],\n    levelTrack: `${LT_PREFIX}unmixed_1_3_88_bpm.ogg`,\n    targetParts: [\n      {\n        sample: \"ch\",\n        steps: [\n          StepState.ON, StepState.OFF, StepState.ACCENT, StepState.OFF,\n          StepState.ON, StepState.OFF, StepState.ACCENT, StepState.OFF,\n          StepState.ON, StepState.OFF, StepState.ACCENT, StepState.OFF,\n          StepState.ON, StepState.OFF, StepState.ACCENT, StepState.OFF,\n        ],\n      },\n    ],\n    startingHand: [\n      \"rearrange\",\n      \"bus\",\n      \"rinse\",\n      \"scour\",\n      \"dry\",\n    ],\n    startingSchedule: [\n      \"feast\",\n    ],\n    hints: [\n      \"You've been working hard! You've arrived just in time for dinner.\",\n      \"Err.. Or rather, just in time for cleaning the tables and dishes from dinner...\",\n    ],\n  },\n  // 3\n  {\n    title: \"Putting it All Together\",\n    description: [\n      \"Wow, all the tables and dishes look great!\",\n      \"You've worked hard.\",\n      \"It's time to meet the master...\"\n    ],\n    levelTrack: `${LT_PREFIX}unmixed_1_all_88_bpm.ogg`,\n    overrideTrackBars: 12,\n    targetParts: [\n      {\n        sample: \"sd\",\n        steps: [\n          StepState.OFF, StepState.OFF, StepState.OFF, StepState.OFF,\n          StepState.ACCENT, StepState.OFF, StepState.OFF, StepState.OFF,\n          StepState.OFF, StepState.OFF, StepState.OFF, StepState.OFF,\n          StepState.ACCENT, StepState.OFF, StepState.OFF, StepState.OFF,\n        ],\n      },\n      {\n        sample: \"bd\",\n        steps: [\n          StepState.ON, StepState.OFF, StepState.OFF, StepState.OFF,\n          StepState.ON, StepState.OFF, StepState.OFF, StepState.OFF,\n          StepState.ON, StepState.OFF, StepState.OFF, StepState.OFF,\n          StepState.ON, StepState.OFF, StepState.OFF, StepState.OFF,\n        ],\n      },\n      {\n        sample: \"ch\",\n        steps: [\n          StepState.ON, StepState.OFF, StepState.ACCENT, StepState.OFF,\n          StepState.ON, StepState.OFF, StepState.ACCENT, StepState.OFF,\n          StepState.ON, StepState.OFF, StepState.ACCENT, StepState.OFF,\n          StepState.ON, StepState.OFF, StepState.ACCENT, StepState.OFF,\n        ],\n      },\n    ],\n    startingHand: [\n      \"laundry\",\n      \"floor\",\n      \"dishes\",\n    ],\n    startingSchedule: [],\n    hints: [\n      \"Show me what you've done today!\"\n    ]\n  },\n  {\n    title: \"Day 2\",\n    description: [\n      \"After the tutorial.\",\n    ],\n    levelTrack: `${LT_PREFIX}unmixed_2_1_112_bpm.ogg`,\n    overrideBPM: 112,\n    targetParts: [\n      {\n        sample: \"bd\",\n        steps: [\n          StepState.ON, StepState.ON, StepState.OFF, StepState.OFF,\n          StepState.OFF, StepState.ON, StepState.OFF, StepState.ON,\n          StepState.OFF, StepState.ON, StepState.OFF, StepState.ON,\n          StepState.OFF, StepState.OFF, StepState.ON, StepState.OFF,\n        ],\n      },\n      {\n        sample: \"sd\",\n        steps: [\n          StepState.OFF, StepState.OFF, StepState.OFF, StepState.OFF,\n          StepState.ACCENT, StepState.OFF, StepState.OFF, StepState.OFF,\n          StepState.OFF, StepState.OFF, StepState.OFF, StepState.OFF,\n          StepState.ON, StepState.OFF, StepState.OFF, StepState.OFF,\n        ],\n      },\n      {\n        sample: \"ch\",\n        steps: [\n          StepState.ACCENT, StepState.ACCENT, StepState.ACCENT, StepState.ACCENT,\n          StepState.OFF, StepState.ACCENT, StepState.ON, StepState.ON,\n          StepState.ACCENT, StepState.ON, StepState.ON, StepState.ON,\n          StepState.OFF, StepState.ON, StepState.ACCENT, StepState.ON,\n        ],\n      },\n    ],\n    startingHand: [\n    ],\n    startingSchedule: [\n    ],\n    hints: [\n      \"Things are starting to get hard...\",\n    ],\n  },\n  */\n];\n\nexport default Puzzles;","import { Modal, Paper } from \"@material-ui/core\";\nimport { useEffect, useState } from \"react\";\nimport Puzzles from \"../Puzzles\";\n\n// Automatically opens when description is updated.\nexport default function TurnDescription({turn, onDismiss} : {turn: number, onDismiss: any}) {\n  const [lastAcknowledgedTurn, setLastAcknowledgedTurn] = useState(turn);\n  const [show, setShow] = useState(true);\n  useEffect(() => {\n    if (turn !== lastAcknowledgedTurn) {\n      setShow(true);\n    }\n  }, [lastAcknowledgedTurn, turn]);\n  const onClose = () => {\n    setShow(false);\n    setLastAcknowledgedTurn(turn);\n    onDismiss();\n  };\n  const puzzle = Puzzles[turn - 1];\n  return <Modal open={show} onClose={onClose} onClick={onClose}>\n    <Paper variant=\"outlined\" className=\"event-modal\">\n      <div className=\"event-body\">\n        <h1>{puzzle.title}</h1>\n        {puzzle.description.map((descriptionLine, i) => <p key={i}>{descriptionLine}</p>)}\n        <p><em>Press Escape or click/tap anywhere to continue...</em></p>\n      </div>\n    </Paper>\n  </Modal>;\n}","import { LinearProgress } from \"@material-ui/core\";\n\nexport default function TrackProgress({progress, max}: {progress: number | null, max: number}) {\n  return <LinearProgress className=\"progress-bar\" variant=\"determinate\" value={\n    100.0 * (progress === null ? 0 : progress + 1) / max\n  }/>;\n}","import {\n  BoardProps \n} from 'boardgame.io/react'\n\nimport {\n  Button,\n  Grid,\n} from '@material-ui/core';\n\nimport CardSequence from './CardSequence';\nimport SampleGrid from './SampleGrid';\nimport { GameState, StepState } from '../Types';\nimport { range } from 'lodash';\nimport React, { useCallback, useEffect, useState } from 'react';\nimport { DEFAULT_BPM, DEFAULT_TRACK_BARS, SECONDS_PER_STEP, STEP_COUNT } from '../Constants';\nimport * as Tone from 'tone';\nimport { Time } from 'tone/build/esm/core/type/Units';\nimport LevelDescription from './LevelDescription';\nimport TrackProgress from './TrackProgress';\nimport { Player, Sequence } from 'tone';\nimport { CSSTransition, SwitchTransition } from 'react-transition-group';\nimport Cards from '../Cards';\nimport ReactMarkdown from 'react-markdown';\n\n\n/* From https://gist.github.com/malthe/02350255c759d5478e89 */\nfunction dedent(text: string): string {\n  var re_whitespace = /^([ \\t]*)(.*)\\n/gm;\n  var l, m, i;\n\n  while ((m = re_whitespace.exec(text)) !== null) {\n    if (!m[2]) continue;\n\n    /*eslint no-cond-assign: 0*/\n    if (l = m[1].length) {\n      i = (i !== undefined) ? Math.min(i, l) : l;\n    } else break;\n  }\n\n  if (i)\n    text = text.replace(new RegExp('^[ \\t]{' + i + '}(.*\\n)', 'gm'), '$1');\n\n  return text;\n}\n\nfunction ContinueButton({G, onClick} : {G: GameState, onClick: any} ) {\n  const enabled = G.hasClearedLevel;\n  return <Button variant=\"contained\" onClick={onClick} disabled={!enabled} className={enabled ? \"glow\" : \"\"}>\n    next\n  </Button>;\n}\nconst keyMapper: { [key: string]: {pitch: string, duration: string}} = {\n  cy: {\n    pitch: \"f4\",\n    duration: \"2n\",\n  },\n  bd: {\n    pitch: \"e4\",\n    duration: \"16n\",\n  },\n  ch: {\n    pitch: \"d4\",\n    duration: \"16n\",\n  },\n  sd: {\n    pitch: \"c4\",\n    duration: \"16n\",\n  }\n};\n\nconst sampler = new Tone.Sampler({\n  urls: {\n    // Cymbal\n    f4: \"CY/E808_CY-12[short].ogg\",\n    // Bass Drum\n    e4: \"BD/E808_BD[short]-03.wav\",\n    // Closed Hat\n    d4: \"CH/E808_CH-06.wav\",\n    // Snare\n    c4: \"SD/E808_SD-07.wav\",\n  },\n  baseUrl: process.env.PUBLIC_URL + \"/samples/808/\"\n}).toDestination();\n\nexport default function Board({\n  G, ctx, moves  \n} : React.HTMLAttributes<HTMLElement> & BoardProps<GameState>)\n{\n  const {\n    title,\n    hasClearedLevel,\n    hints,\n    levelTrack,\n    playerParts,\n    targetParts,\n    playerHand,\n    playerSchedule,\n    startingSchedule,\n    overrideTrackBars,\n    overrideBPM,\n  } = G;\n  const trackBars = overrideTrackBars ?? DEFAULT_TRACK_BARS;\n  const bpm = overrideBPM ?? DEFAULT_BPM;\n  useEffect(() => {\n    Tone.Transport.bpm.value = bpm;\n    Tone.start();\n    Tone.Transport.start();\n    return () => {\n      Tone.Transport.stop();\n    }\n  }, [bpm]);\n  const [npcDialog, setNpcDialog] = useState(hints);\n  const [selectedPart, setSelectedPart] = useState(0);\n  useEffect(() => {\n    // On new level or card played/removed.\n    if (playerSchedule.length === startingSchedule.length) {\n      setNpcDialog(hints);\n    }\n    if (playerSchedule.length > 0) {\n      const lastCard = Cards[playerSchedule[0]];\n      const partOfLastCard = playerParts.findIndex((e) => e.sample === lastCard.sampleTarget);\n      if (partOfLastCard >= 0) {\n        setSelectedPart(partOfLastCard);\n      }\n    }\n  }, [hints, playerParts, playerSchedule, startingSchedule.length]);\n  useEffect(() => {\n    setSelectedPart(0);\n  }, [ctx.turn]);\n  const [currentlyPlayingStep, setCurrentlyPlayingStep] = useState<number | null>(null);\n  const [lastPlayedStep, setLastPlayedStep] = useState<number | null>(null);\n  const [currentTime, setCurrentTime] = useState<Time | undefined>(undefined);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [playerActive, setPlayerActive] = useState(true);\n  const [player, setPlayer] = useState<Player | null>(null);\n  const [sequence, setSequence] = useState<Sequence | null>(null);\n  const onStep = (time: Time, stepId: number) => {\n    // This is a bit subtle: time has to be set before step.\n    // Only step triggers the sample side effect.\n    setCurrentTime(time);\n    setCurrentlyPlayingStep(stepId);\n  };\n  const play = () => {\n    if (isPlaying) {\n      return;\n    }\n    const sequencer = new Tone.Sequence(\n      onStep,\n      // One extra beat to resolve animations.\n      range(STEP_COUNT * trackBars + 1),\n      \"16n\"\n    );\n    // Just to prevent overlap.\n    stop();\n    setSequence(sequencer);\n    const player = new Tone.Player(\n      levelTrack,\n      () => {\n        setIsPlaying(true);\n        Tone.start();\n        sequencer.loop = false;\n        sequencer.start();\n      }\n    ).toDestination();\n    setPlayer(player);\n    player.loop = false;\n    player.autostart = true;\n  };\n  const stop = useCallback(() => {\n    if (!isPlaying) {\n      return;\n    }\n    setCurrentTime(undefined);\n    setLastPlayedStep(null);\n    setCurrentlyPlayingStep(null);\n    sequence?.stop();\n    setSequence(null);\n    player?.stop();\n    setPlayer(null);\n    setIsPlaying(false);\n    setPlayerActive(true);\n  }, [isPlaying, sequence, player]);\n  useEffect(() => {\n    if (lastPlayedStep === currentlyPlayingStep) {\n      return;\n    }\n    if(typeof currentTime === 'undefined') {\n      return;\n    }\n    if (currentlyPlayingStep === null) {\n      return;\n    }\n    if (!isPlaying) {\n      return;\n    }\n    if (currentlyPlayingStep >= (STEP_COUNT * trackBars)) {\n      stop();\n      return;\n    }\n    setLastPlayedStep(currentlyPlayingStep);\n    // stepIndex selects from our step sequencer, which is only 16th notes on repeat.\n    const stepIndex = currentlyPlayingStep % STEP_COUNT;\n    const parts = playerActive ? playerParts : targetParts;\n    for (let part of parts) {\n      if (part.steps[stepIndex] !== StepState.OFF) {\n        sampler.triggerAttackRelease(\n          keyMapper[part.sample].pitch, \n          keyMapper[part.sample].duration,\n          currentTime,\n          part.steps[stepIndex] / 2\n        );\n      }\n    }\n  }, [currentTime, playerParts, targetParts, currentlyPlayingStep, lastPlayedStep, playerActive, isPlaying, stop, trackBars])\n  const onViewCard = (i: number) => {\n    const selectedCard = Cards[playerHand[i]];\n    if (selectedCard) {\n      setNpcDialog([selectedCard.description]);\n    }\n  };\n  return <Grid container className=\"game-board\" alignItems=\"center\" justify=\"center\">\n    <LevelDescription\n      key={\"ld:\" + ctx.turn}\n      turn={ctx.turn}\n      onDismiss={() => {\n        // On a new level, play the target first.\n        setPlayerActive(false);\n        play();\n      }}\n    />\n    <Grid item xs={12} key=\"title\">\n      <h1>{title}</h1>\n    </Grid>\n    <Grid item xs={3} className=\"pc-area portrait-area\" key=\"pc-area\">\n      <div className=\"pc portrait\">\n        <Button\n          variant=\"contained\"\n          disabled={playerActive}\n          className={playerActive ? \"selected\" : \"\"}\n          onClick={() => {\n            setPlayerActive(true);\n            play();\n          }}\n        >\n          My Parts\n        </Button>\n      </div>\n    </Grid>\n    <Grid item xs={6} className=\"parts-area\">\n      <Grid container className=\"parts\" justify=\"center\" key=\"parts\">\n        <Grid item xs={1} key=\"time-elapsed\">\n          {isPlaying && \n            <span>\n              {((currentlyPlayingStep ?? 0)  * SECONDS_PER_STEP).toFixed(1)}\n            </span>\n          }\n        </Grid>\n        <Grid item xs={10} key=\"progress\">\n          <TrackProgress progress={currentlyPlayingStep} max={trackBars * STEP_COUNT} />\n        </Grid>\n        <Grid item xs={1} key=\"time-remaining\">\n          {isPlaying && \n            <span>\n              {(((trackBars * STEP_COUNT) - (currentlyPlayingStep ?? 0))  * SECONDS_PER_STEP).toFixed(1)}\n            </span>\n          }\n        </Grid>\n        <Grid item xs={12} className=\"start-stop\" key=\"start-stop\">\n          <Button\n            className={isPlaying ? \"stop\" : \"play\"}\n            onClick={isPlaying ? stop : play}\n          >\n            &nbsp;\n          </Button>\n        </Grid>\n        <Grid item xs={12} className=\"current-parts\">\n          <SwitchTransition>\n            <CSSTransition\n              key={playerActive ? \"current\": \"target\"}\n              timeout={200}\n              classNames={playerActive ? \"current\": \"target\"}\n            >\n              <SampleGrid\n                parts={playerActive ? playerParts : targetParts}\n                currentlyPlayingStep={currentlyPlayingStep}\n                className={\"sampler \" + (playerActive ? \"current\" : \"target\")}\n                tabIndex={selectedPart}\n                setTabIndex={setSelectedPart}\n              />\n            </CSSTransition>\n          </SwitchTransition>\n        </Grid>\n      </Grid>\n      <Grid item xs={12} className=\"dialogue\">\n        { typeof(npcDialog) !== 'undefined' && \n          <div>\n            <ReactMarkdown children={dedent(npcDialog.join('\\n\\n'))}/>\n          </div>\n        }\n      </Grid>\n    </Grid>\n    <Grid item xs={3} className=\"npc-area portrait-area\" key=\"npc-area\">\n      <div className=\"npc portrait\">\n        <Button\n          variant=\"contained\"\n          disabled={!playerActive}\n          className={!playerActive ? \"selected\" : \"\"}\n          onClick={() => {\n            setPlayerActive(false);\n            play();\n          }}\n        >\n          Goal \n        </Button>\n      </div>\n    </Grid>\n    <Grid item xs={5} className=\"hand-area\" key=\"hand-area\">\n      <div className=\"label\">\n        <h3>To-Do</h3>\n      </div>\n      <CardSequence\n        key={\"hand:\" + ctx.turn}\n        cards={playerHand}\n        onClickCard={(i: number) => {\n          moves.playCard(i);\n          setPlayerActive(true);\n          play();\n          onViewCard(i);\n        }}\n        buttonLabel=\"Place\"\n        className=\"hand\"\n        unremovable={0}\n        emphasizeButton={!hasClearedLevel}\n      />\n    </Grid>\n    <Grid item xs={2} className=\"next-day\" key=\"next-day\">\n      <Grid container>\n        <Grid item xs={12}>\n          <Button variant=\"contained\" onClick={moves.clearSchedule}>Reset</Button>\n        </Grid>\n        <Grid item xs={12} className=\"break\"></Grid>\n        <Grid item xs={12}>\n          <ContinueButton G={G} onClick={\n            () => {\n              moves.commitSchedule();\n              stop();\n            }\n          }/>\n        </Grid>\n      </Grid>\n    </Grid>\n    <Grid item xs={5} className=\"schedule-area\" key=\"schedule-area\">\n      <div className=\"label\">\n        <h3>Schedule</h3>\n      </div>\n      <CardSequence\n        key={\"schedule:\" + ctx.turn}\n        cards={playerSchedule}\n        onClickCard={(i: number) => {\n          moves.removeCard(i);\n          play();\n        }}\n        buttonLabel=\"Remove\"\n        className=\"schedule\"\n        unremovable={G.startingSchedule.length}\n        emphasizeButton={false}\n      />\n    </Grid>\n  </Grid>;\n}","import { Ctx, Game } from 'boardgame.io';\n\nimport Puzzles from './Puzzles';\nimport Cards from './Cards';\n\nimport { STEP_COUNT } from './Constants';\nimport { GameState, Part, StepSequence, StepState } from './Types';\nimport { INVALID_MOVE } from 'boardgame.io/core';\nimport { reverse } from 'lodash';\n\n\nexport const FLIP:string = \"flip\";\n\nconst EmptyPart: () => StepSequence = () => Array.from({length: STEP_COUNT}, () => StepState.OFF);\n\nconst SetupTurn = (turn: number, oldG?: GameState) => {\n  const puzzle = Puzzles[turn - 1];\n  const playerParts: Array<Part> = puzzle.targetParts.map(\n    (part: Part) => ({\n      sample: part.sample,\n      steps: EmptyPart()\n    })\n  );\n  const newG = {\n    // Immutable stuff.\n    ...puzzle,\n    // Changing stuff.\n    playerParts,\n    playerHand: [...puzzle.startingHand],\n    playerSchedule: [...(puzzle.startingSchedule ?? [])],\n    hasClearedLevel: oldG?.hasClearedLevel ?? false,\n  };\n  // Apply any fixed cards.\n  (puzzle.startingSchedule ?? []).forEach((cardId) => Cards[cardId].playCard(newG))\n  return newG;\n}\n\nexport const CheckLevelComplete: (G: GameState) => boolean = (G: GameState) => {\n  for (const [targetPartIndex, targetPart] of G.targetParts.entries()) {\n    const currentPart = G.playerParts[targetPartIndex];\n    for (let i: number = 0; i < STEP_COUNT; i++) {\n      if (currentPart.steps[i] !== targetPart.steps[i]) {\n        return false;\n      }\n    }\n  }\n  return true;\n}\n\nexport const MyGame: Game = {\n  moves: {\n    playCard: (G: GameState, ctx: Ctx, handSlot: number) => {\n      const cardId = G.playerHand[handSlot];\n      const card = Cards[cardId];\n      if (!card) {\n        return INVALID_MOVE;\n      }\n      card.playCard(G); \n      // Remove the played card.\n      G.playerHand.splice(handSlot, 1);\n      // Add it to the play stack.\n      G.playerSchedule.unshift(cardId);\n      if (CheckLevelComplete(G)) {\n        G.hasClearedLevel = true;\n      }\n    },\n    removeCard: (G: GameState, ctx: Ctx, playerScheduleSlot: number) => {\n      if (G.playerSchedule.length - playerScheduleSlot <= G.startingSchedule.length) {\n        return INVALID_MOVE;\n      }\n\n      const removedCardId = G.playerSchedule[playerScheduleSlot];\n      if (!removedCardId) {\n        return INVALID_MOVE;\n      }\n\n      // Reset the turn and re-apply the cards in sequence. \n      const cleanState: GameState = SetupTurn(ctx.turn, G);\n      \n      // Add the removed card back to the hand.\n      cleanState.playerHand = [...G.playerHand];\n      cleanState.playerHand.unshift(removedCardId);\n\n      const inOrderStack = reverse([...G.playerSchedule]);\n      console.log(inOrderStack);\n      // Re-play the remaining cards in stack order.\n      for (const [replayedCardIndex, replayedCardId] of inOrderStack.entries()) {\n        if (G.playerSchedule.length - replayedCardIndex - 1 === playerScheduleSlot) {\n          // Ignore this removed card.\n          // We need to use the original index.\n          continue;\n        }\n        if (replayedCardIndex < G.startingSchedule.length) {\n          // Not removable...\n          continue;\n        }\n        const replayedCard = Cards[replayedCardId];\n        replayedCard.playCard(cleanState);\n        cleanState.playerSchedule.unshift(replayedCardId);\n      }\n      if (CheckLevelComplete(cleanState)) {\n        G.hasClearedLevel = true;\n      }\n      return cleanState;\n    },\n    clearSchedule: (G: GameState, ctx: Ctx) => {\n      if (CheckLevelComplete(G)) {\n        G.hasClearedLevel = true;\n      }\n      return SetupTurn(ctx.turn, G);\n    },\n    commitSchedule: (G: GameState, ctx: Ctx) => {\n      if (G.hasClearedLevel) {\n        ctx.events?.endTurn?.();\n      }\n    },\n  },\n  turn: {\n    onBegin: (G: GameState, ctx: Ctx) => SetupTurn(ctx.turn)\n  }\n};","import './App.css';\nimport { Client } from 'boardgame.io/react';\nimport Board from './component/Board';\nimport { MyGame } from './Game';\n\nconst App = Client({ game: MyGame, board: Board, numPlayers: 1, debug: true });\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <App/>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}